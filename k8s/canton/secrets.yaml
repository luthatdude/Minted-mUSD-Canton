# Secret templates for Canton deployment
# These are TEMPLATES — do NOT commit real credentials.
#
# PRODUCTION: Use External Secrets Operator (see external-secrets.yaml)
#   ExternalSecret CRDs in external-secrets.yaml pull credentials from
#   AWS Secrets Manager at runtime. Apply those instead of this file.
#
# DEVELOPMENT ONLY — create secrets manually:
#   kubectl create secret generic postgres-credentials \
#     --namespace=musd-canton \
#     --from-literal=username=canton_user \
#     --from-literal=password=<GENERATE_STRONG_PASSWORD>
#
#   kubectl create secret tls canton-tls \
#     --namespace=musd-canton \
#     --cert=path/to/tls.crt \
#     --key=path/to/tls.key
#
#   kubectl create secret generic canton-tls \
#     --namespace=musd-canton \
#     --from-file=tls.crt=path/to/tls.crt \
#     --from-file=tls.key=path/to/tls.key \
#     --from-file=ca.crt=path/to/ca.crt
#
# Removed placeholder values to prevent accidental deployment with defaults.
# Secrets MUST be created via kubectl, External Secrets Operator, or Vault before deployment.
# See: k8s/canton/external-secrets.yaml for production configuration.
---
apiVersion: v1
kind: Secret
metadata:
  name: postgres-credentials
  namespace: musd-canton
  labels:
    app.kubernetes.io/name: postgres
    app.kubernetes.io/component: database
  annotations:
    kubernetes.io/description: "REQUIRED: Create via kubectl create secret - see comments above"
type: Opaque
# Empty stringData - deployment will fail until secrets are properly configured
# This is intentional to prevent using default credentials in production
stringData: {}
---
# TLS certificates for Canton Ledger API
# In production, use cert-manager with Let's Encrypt or internal CA
apiVersion: v1
kind: Secret
metadata:
  name: canton-tls
  namespace: musd-canton
  labels:
    app.kubernetes.io/name: canton-participant
    app.kubernetes.io/component: tls
type: kubernetes.io/tls
data:
  tls.crt: ""  # base64-encoded certificate chain
  tls.key: ""  # base64-encoded private key
  ca.crt: ""   # base64-encoded CA certificate
---
# JSON API credentials referenced by participant-deployment.yaml
# This secret was missing, causing deployment to fail
#
# Create via:
#   kubectl create secret generic json-api-credentials \
#     --namespace=musd-canton \
#     --from-literal=jwt-secret=<GENERATE_256_BIT_SECRET>
#
apiVersion: v1
kind: Secret
metadata:
  name: json-api-credentials
  namespace: musd-canton
  labels:
    app.kubernetes.io/name: canton-participant
    app.kubernetes.io/component: json-api
  annotations:
    kubernetes.io/description: "REQUIRED: JWT secret for JSON API authentication"
type: Opaque
# Empty stringData - deployment will fail until secret is configured
# Generate a 256-bit secret: openssl rand -base64 32
stringData: {}
